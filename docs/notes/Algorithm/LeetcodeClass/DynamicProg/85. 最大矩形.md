# 85. 最大矩形

```javascript
/*
 * @lc app=leetcode.cn id=85 lang=javascript
 *
 * [85] 最大矩形
 */

// @lc code=start
/**
 * @param {character[][]} matrix
 * @return {number}
 */
var maximalRectangle = function (matrix) {
  let maxNum = 0;
  // 初始化宽度dp
  const leftDp = Array.from({ length: matrix.length }, () =>
    Array(matrix[0].length).fill(0)
  );
  // 最长矩形dp
  const dp = Array.from({ length: matrix.length }, () =>
    Array(matrix[0].length).fill(0)
  );
  // 计算每个节点相对于左侧的宽度
  for (let i = 0; i < matrix.length; i++) {
    for (let j = 0; j < matrix[0].length; j++) {
      if (j === 0) {
        // 如果是最左侧的话 宽度默认为当前值 要么是数字1或者数字0
        leftDp[i][j] = +matrix[i][j];
      } else {
        // 反之如果是1的话 是基于左侧的值+1
        if (matrix[i][j] === "1") {
          leftDp[i][j] = leftDp[i][j - 1] + 1;
        }
      }
      // 因为下面的循环可能进不去 比如说只有一行的情况下 那么这里也需要更新下最长的长度值
      maxNum = Math.max(maxNum, leftDp[i][j]);
    }
  }
  // 循环数据 外层从第二层开始 因为第一层不会在往上继续了 所以都是最大值
  for (let i = 1; i < matrix.length; i++) {
    for (let j = 0; j < matrix[0].length; j++) {
      // 判断当前如果是1的话 初始化高度, 宽度 轮训向上 一直更新宽度和高度 直到为0暂停
      if (matrix[i][j] === "1") {
        // 初始化当前高度是1 宽度就是当前leftDp的值
        let h = 1;
        let width = leftDp[i][j];
        // 边界条件就是 i-h >=0
        while (i - h >= 0) {
          if (leftDp[i - h][j] > 0) {
            // 如果大于0表示存在长方形 更新宽度高度 计算面积 更新最大值
            // 宽度是当前宽度和上面的宽度 取最小值
            width = Math.min(width, leftDp[i - h][j]);
            // 每次循环高度都会自增1
            h++;
            // 更新当前dp最大值
            dp[i][j] = Math.max(dp[i][j], width * h);
            // 更新总的最大值
            maxNum = Math.max(maxNum, dp[i][j]);
          } else {
            // 直接停止循环
            break;
          }
        }
      }
    }
  }
  // console.log(leftDp);
  // console.log(dp);
  return maxNum;
};
// @lc code=end

console.log(
  maximalRectangle([
    ["1", "0", "1", "0", "0"],
    ["1", "0", "1", "1", "1"],
    ["1", "1", "1", "1", "1"],
    ["1", "0", "0", "1", "0"],
  ])
); // 6

console.log(
  maximalRectangle([
    ["1", "0", "1", "1", "0"],
    ["1", "1", "1", "1", "1"],
    ["1", "1", "1", "1", "0"],
    ["1", "0", "0", "1", "0"],
  ])
); // 8

console.log(maximalRectangle([[0]])); // 0
console.log(maximalRectangle([[1]])); // 1
```
